<div class="min-h-screen bg-gray-100 p-8 container">
  <div class="mx-auto">
    <h1 class="text-3xl font-bold text-gray-800 mb-6">Image Editor</h1>

    <!-- Upload Section -->
    @if (!imageLoaded()) {
      <div class="bg-white rounded-lg shadow-md p-6 mb-6">
        <label
          class="flex flex-col items-center justify-center w-full h-64 border-2 border-dashed border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50">
          <div class="flex flex-col items-center justify-center pt-5 pb-6">
            <svg class="w-12 h-12 text-gray-400 mb-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"/>
            </svg>
            <p class="mb-2 text-sm text-gray-500"><span class="font-semibold">Click to upload</span> or drag and drop
            </p>
            <p class="text-xs text-gray-500">PNG, JPG, GIF up to 10MB</p>
          </div>
          <input #fileInput type="file" class="hidden" accept="image/*" (change)="onFileSelected($event)"/>
        </label>
      </div>
    }

    <!-- Editor Section -->
    @if (true) {
      <div class="bg-white rounded-lg shadow-md p-6">
        <!-- Toolbar -->
        <div class="flex flex-wrap items-center gap-4 mb-6 p-4 bg-gray-50 rounded-lg">
          <!-- Tool Selection -->
          <div class="flex gap-2">
            <button
              (click)="updateMode('draw')"
              [class.bg-blue-500]="currentTool() === 'draw'"
              [class.text-white]="currentTool() === 'draw'"
              [class.bg-white]="currentTool() !== 'draw'"
              class="px-4 py-2 rounded-lg border-2 border-gray-300 hover:bg-blue-100 transition-colors font-medium">
              ‚úèÔ∏è Draw
            </button>
            <button
              (click)="updateMode('erase')"
              [class.bg-blue-500]="currentTool() === 'erase'"
              [class.text-white]="currentTool() === 'erase'"
              [class.bg-white]="currentTool() !== 'erase'"
              class="px-4 py-2 rounded-lg border-2 border-gray-300 hover:bg-blue-100 transition-colors font-medium">
              üßπ Erase
            </button>
          </div>

          <!-- Color Picker -->
          <div class="flex items-center gap-2">
            <label class="font-medium text-gray-700">Color:</label>
            <input
              type="color"
              [(ngModel)]="currentColor"
              (ngModelChange)="updateColor($event)"
              class="w-12 h-10 rounded cursor-pointer border-2 border-gray-300"/>
          </div>

          <!-- Predefined Colors -->
          <div class="flex flex-wrap gap-2">
            @for (color of predefinedColors; track color) {
              <button
                (click)="updateColor(color)"
                [style.background-color]="color"
                [class.ring-4]="currentColor() === color"
                [class.ring-blue-400]="currentColor() === color"
                class="w-10 h-10 rounded-lg border-2 border-gray-300 hover:scale-110 transition-transform">
              </button>
            }
          </div>

          <!-- Brush Size -->
          <div class="flex items-center gap-2">
            <label class="font-medium text-gray-700">Size:</label>
            <input
              type="range"
              [ngModel]="brushSize()"
              (ngModelChange)="updateBrushSize($event)"
              min="1"
              max="50"
              class="w-32"/>
            <span class="text-sm text-gray-600 w-8">{{ brushSize() }}</span>
          </div>

          <!-- Actions -->
          <div class="flex flex-wrap gap-2 ml-auto">
            <button
              (click)="signaturePad.clear()"
              class="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors font-medium">
              Clear
            </button>
            <button
              (click)="clickDownloadImage()"
              class="px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors font-medium">
              Download
            </button>
            <button
              (click)="undo()"
              class="px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors font-medium">
              New Image
            </button>
          </div>
        </div>

        <div class="flex justify-center border-2 border-gray-300 rounded-lg overflow-hidden bg-gray-50 w-fit">
          <canvas
            #signatureCanvas
            class="cursor-crosshair"
          >
          </canvas>
        </div>
      </div>
    }
  </div>
</div>
